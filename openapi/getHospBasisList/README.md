# 병원정보조회 웹 애플리케이션 사용 가이드

## 📋 목차
1. [개요](#개요)
2. [시작하기](#시작하기)
3. [사용 방법](#사용-방법)
4. [기능 설명](#기능-설명)
5. [문제 해결](#문제-해결)

---

## 개요

### 서비스 정보
- **애플리케이션명**: 병원정보조회 웹앱
- **파일명**: `병원정보조회_웹앱.html`
- **데이터 제공**: 건강보험심사평가원
- **API**: 병원정보서비스 (HospInfoService1)

### 주요 기능
- ✅ 다양한 조건으로 병원 정보 검색
- ✅ 검색 결과 테이블 형태로 표시
- ✅ 페이징 기능
- ✅ 엑셀 파일로 다운로드
- ✅ 반응형 디자인 (모바일, 태블릿, PC 지원)

---

## 시작하기

### 1. 필수 준비사항

#### API 인증키 발급
병원정보조회 API를 사용하려면 공공데이터포털에서 인증키를 발급받아야 합니다.

**발급 절차:**
1. [공공데이터포털](https://www.data.go.kr) 접속 및 회원가입/로그인
2. [병원정보서비스 OpenAPI](https://www.data.go.kr/data/15051059/openapi.do) 페이지 접속
3. **활용신청** 버튼 클릭
4. 신청 정보 입력 및 제출
5. 자동승인 (약 30분 후 사용 가능)
6. [마이페이지 > 인증키 발급현황](https://www.data.go.kr/iim/api/selectApiKeyList.do)에서 인증키 확인

> [!IMPORTANT]
> - 개발계정은 **일 1,000건** 트래픽 제한이 있습니다
> - 인증키 발급 후 약 30분 뒤부터 사용 가능합니다

### 2. 웹 애플리케이션 실행

> [!WARNING]
> **CORS 정책으로 인한 실행 제한**
> 
> 이 파일을 직접 더블 클릭하여 실행(`file://` 프로토콜)하면 브라우저의 CORS(Cross-Origin Resource Sharing) 정책으로 인해 API 호출이 차단됩니다.
> 
> 반드시 아래의 방법 중 하나로 **로컬 웹 서버**를 통해 실행해야 합니다.

#### 방법 1: VS Code Live Server (권장)

1. **VS Code 확장 프로그램 설치**
   - VS Code 열기
   - 확장(Extensions) 탭 클릭 (Ctrl+Shift+X)
   - "Live Server" 검색 및 설치

2. **웹 서버 실행**
   - `병원정보조회_웹앱.html` 파일을 VS Code에서 열기
   - 파일 우클릭 → "Open with Live Server" 선택
   - 또는 하단 상태바의 "Go Live" 버튼 클릭

3. **브라우저 자동 실행**
   - `http://localhost:5500/병원정보조회_웹앱.html` 주소로 자동 실행
   - 이제 CORS 오류 없이 정상 작동

#### 방법 2: Python 내장 서버

```bash
# Python 3가 설치되어 있는 경우
cd d:\git_rk\openapi\getHospBasisList
python -m http.server 8000

# 브라우저에서 접속
# http://localhost:8000/병원정보조회_웹앱.html
```

#### 방법 3: Node.js http-server

```bash
# http-server 설치 (한 번만)
npm install -g http-server

# 서버 실행
cd d:\git_rk\openapi\getHospBasisList
http-server -p 8000

# 브라우저에서 접속
# http://localhost:8000/병원정보조회_웹앱.html
```

### 3. API 인증키 사용 가이드

> [!IMPORTANT]
> **디코딩(Decoding) 인증키를 사용하세요**

공공데이터포털에서는 두 가지 형태의 인증키를 제공합니다:

| 인증키 종류 | 형태 | 예시 | 사용 여부 |
|-----------|------|------|----------|
| **인코딩 인증키** | 특수문자가 URL 인코딩됨 | `abc123%2Bdef456%3D%3D` | ❌ 사용하지 마세요 |
| **디코딩 인증키** | 원본 형태 | `abc123+def456==` | ✅ 이것을 사용하세요 |

#### 왜 디코딩 인증키를 사용해야 하나요?

이 웹 애플리케이션은 `URLSearchParams` 객체를 사용하여 API 요청을 구성합니다. 이 객체는 자동으로 특수문자를 인코딩하므로:

- **디코딩 키 입력** → 자동 인코딩 → ✅ 정상 작동
- **인코딩 키 입력** → 이중 인코딩 → ❌ "등록되지 않은 인증키" 오류

#### 디코딩 인증키 확인 방법

1. [공공데이터포털](https://www.data.go.kr) 로그인
2. [마이페이지 > 인증키 발급현황](https://www.data.go.kr/iim/api/selectApiKeyList.do) 접속
3. 병원정보서비스 API 찾기
4. **"일반 인증키(Decoding)"** 열의 값을 복사
5. 웹 애플리케이션의 인증키 입력 필드에 붙여넣기

> [!NOTE]
> 인터넷 연결이 필요합니다 (외부 라이브러리 및 API 호출)

---

## 사용 방법

### 기본 사용 흐름

```
1. API 인증키 입력
   ↓
2. 검색 조건 설정 (시도, 시군구, 병원명 등)
   ↓
3. "검색하기" 버튼 클릭
   ↓
4. 검색 결과 확인
   ↓
5. 필요시 엑셀 다운로드
```

### 단계별 상세 가이드

#### Step 1: API 인증키 입력
![섹션 I](image)

1. 화면 상단의 **"Ⅰ. 공공데이터 포털 OpenAPI 인증키"** 섹션을 찾습니다
2. 발급받은 인증키를 입력 필드에 붙여넣습니다
3. 인증키는 한 번만 입력하면 됩니다 (페이지를 새로고침하기 전까지 유지)

#### Step 2: 검색 조건 설정
![섹션 II](image)

**"Ⅱ. 검색 조건"** 섹션에서 원하는 조건을 선택/입력합니다:

| 검색 조건 | 설명 | 예시 |
|----------|------|------|
| **시도** | 시/도 선택 (드롭다운) | 서울, 부산, 경기 등 |
| **시군구** | 시/군/구 선택 (시도 선택 후 활성화) | 강남구, 해운대구 등 |
| **병원명** | 병원 이름으로 검색 (부분 검색 가능) | "서울의료원" |
| **읍면동명** | 읍/면/동 이름으로 검색 | "신내동" |
| **종별** | 병원 종류 선택 | 종합병원, 의원, 치과 등 |
| **진료과목** | 진료 과목 선택 | 내과, 외과, 소아청소년과 등 |
| **결과 수** | 한 페이지에 표시할 결과 개수 | 10, 20, 50, 100개 |

> [!TIP]
> - 모든 조건을 입력할 필요는 없습니다. 원하는 조건만 선택하세요
> - 조건을 많이 설정할수록 검색 결과가 좁아집니다
> - 시도만 선택하면 해당 시도의 모든 병원이 검색됩니다

#### Step 3: 검색 실행

1. 검색 조건 설정 후 **"🔍 검색하기"** 버튼을 클릭합니다
2. 데이터를 불러오는 동안 로딩 표시가 나타납니다
3. 검색이 완료되면 결과가 테이블 형태로 표시됩니다

#### Step 4: 검색 결과 확인
![섹션 III](image)

**"Ⅲ. 검색 결과"** 섹션에 다음 정보가 표시됩니다:

**결과 요약:**
- 총 검색 건수
- 현재 표시 중인 범위 (예: 1-50건)

**결과 테이블:**
| 컬럼 | 설명 |
|------|------|
| 번호 | 순번 |
| 병원명 | 병원 이름 |
| 종별 | 병원 종류 (종합병원, 의원 등) |
| 주소 | 병원 주소 |
| 전화번호 | 병원 전화번호 |
| 의사수 | 총 의사 수 |
| 개설일자 | 병원 개설일 |

**페이징:**
- 결과가 많을 경우 페이지 번호가 표시됩니다
- 페이지 번호를 클릭하거나 "이전/다음" 버튼으로 이동할 수 있습니다

#### Step 5: 엑셀 다운로드

1. 검색 결과 상단의 **"📥 엑셀 다운로드"** 버튼을 클릭합니다
2. 현재 페이지의 검색 결과가 엑셀 파일로 다운로드됩니다
3. 파일명 형식: `병원정보_YYYYMMDD_HHMMSS.xlsx`

**엑셀 파일 포함 정보:**
- 번호, 병원명, 종별
- 시도, 시군구, 읍면동
- 주소, 우편번호
- 전화번호, 홈페이지
- 개설일자
- 의사총수, 의과전문의, 치과전문의, 한방전문의
- 경도, 위도

> [!NOTE]
> 엑셀 다운로드는 **현재 페이지의 결과만** 포함됩니다. 전체 결과를 다운로드하려면 "결과 수"를 늘리거나 여러 페이지를 각각 다운로드해야 합니다.

---

## 기능 설명

### 검색 조건 조합 예시

#### 예시 1: 특정 지역의 종합병원 찾기
```
시도: 서울
시군구: 강남구
종별: 종합병원
→ 서울 강남구의 모든 종합병원 검색
```

#### 예시 2: 특정 병원명으로 검색
```
병원명: 서울의료원
→ "서울의료원"이 포함된 모든 병원 검색
```

#### 예시 3: 특정 진료과목이 있는 병원 찾기
```
시도: 부산
진료과목: 소아청소년과
→ 부산의 소아청소년과가 있는 모든 병원 검색
```

#### 예시 4: 특정 동네의 의원 찾기
```
시도: 경기
시군구: 성남시 분당구
읍면동명: 정자동
종별: 의원
→ 경기 성남시 분당구 정자동의 모든 의원 검색
```

### 페이징 기능

- **자동 페이징**: 검색 결과가 설정한 "결과 수"보다 많으면 자동으로 페이지가 나뉩니다
- **페이지 이동**: 
  - 페이지 번호 클릭: 해당 페이지로 이동
  - "« 이전" 버튼: 이전 페이지로 이동
  - "다음 »" 버튼: 다음 페이지로 이동
- **페이지 표시**: 현재 페이지 기준 ±2 페이지까지 표시

### 반응형 디자인

이 웹 애플리케이션은 다양한 화면 크기에 최적화되어 있습니다:

- **PC (1400px 이상)**: 모든 기능 최적 표시
- **태블릿 (768px ~ 1400px)**: 레이아웃 자동 조정
- **모바일 (768px 이하)**: 
  - 검색 조건이 세로로 배치
  - 테이블 가로 스크롤 지원
  - 버튼 크기 최적화

---

## 문제 해결

### 자주 발생하는 문제

#### 1. "공공데이터포털 OpenAPI 인증키를 입력해 주세요" 경고

**원인**: 인증키를 입력하지 않고 검색 버튼을 클릭했습니다.

**해결방법**:
1. 섹션 I의 인증키 입력 필드에 발급받은 인증키를 입력하세요
2. 인증키가 없다면 [공공데이터포털](https://www.data.go.kr)에서 발급받으세요

#### 2. "등록되지 않은 인증키입니다" 오류

**원인**: 
- 잘못된 인증키를 입력했습니다
- 인증키가 아직 활성화되지 않았습니다

**해결방법**:
1. [마이페이지](https://www.data.go.kr/iim/api/selectApiKeyList.do)에서 인증키를 다시 확인하세요
2. 인증키 발급 후 30분이 지났는지 확인하세요
3. 인증키 복사 시 앞뒤 공백이 포함되지 않았는지 확인하세요

#### 3. "검색 결과가 없습니다" 메시지

**원인**: 입력한 검색 조건에 맞는 병원이 없습니다.

**해결방법**:
1. 검색 조건을 줄여보세요 (예: 병원명만 입력)
2. 병원명 검색 시 정확한 이름이 아닌 일부만 입력해 보세요
3. 시도/시군구만 선택하고 다른 조건은 비워두세요

#### 4. "일일 트래픽 제한 초과" 오류

**원인**: 개발계정의 일일 트래픽 제한(1,000건)을 초과했습니다.

**해결방법**:
1. 다음 날까지 기다리세요 (자정에 리셋)
2. 운영계정이 필요한 경우 공공데이터포털에 별도 신청하세요

#### 5. 엑셀 다운로드가 안 됨

**원인**: 
- 브라우저 팝업 차단 설정
- 검색 결과가 없는 상태

**해결방법**:
1. 먼저 검색을 실행하여 결과가 있는지 확인하세요
2. 브라우저의 팝업 차단을 해제하세요
3. 다른 브라우저(Chrome, Edge, Firefox)를 사용해 보세요

#### 6. 페이지가 느리게 로드됨

**원인**: 
- 인터넷 연결 속도가 느립니다
- API 서버가 일시적으로 느립니다

**해결방법**:
1. 인터넷 연결을 확인하세요
2. 잠시 후 다시 시도하세요
3. "결과 수"를 줄여보세요 (100 → 50 → 10)

### 에러 코드별 해결 방법

| 에러 코드 | 메시지 | 해결 방법 |
|----------|--------|----------|
| 00 | 정상 | - |
| 3 | 데이터 없음 | 검색 조건 변경 |
| 22 | 트래픽 초과 | 다음 날 재시도 또는 운영계정 신청 |
| 30 | 미등록 서비스키 | 인증키 확인 및 재발급 |
| 31 | 기한 만료 | 인증키 재발급 |

---

## 추가 정보

### 시스템 요구사항
- **브라우저**: Chrome, Edge, Firefox, Safari (최신 버전 권장)
- **인터넷**: 필수 (API 호출 및 외부 라이브러리 로드)
- **화면 해상도**: 최소 320px (모바일 지원)

### 사용 제한
- **일일 트래픽**: 1,000건 (개발계정 기준)
- **한 번에 조회 가능한 최대 결과 수**: 100건 (페이징 사용)

### 데이터 갱신 주기
- 공공데이터포털과 건강보험심사평가원 간 동기화: 약 30분
- 실시간 데이터가 아닐 수 있습니다

### 지원 및 문의
- **API 관련**: [공공데이터포털 고객센터](https://www.data.go.kr)
- **데이터 관련**: [건강보험심사평가원](https://www.hira.or.kr)

---

## 버전 정보
- **애플리케이션 버전**: 1.0
- **최종 수정일**: 2026-01-13
- **개발**: OpenAPI 활용 웹 애플리케이션
