# Personal.xlsb에 기업명 클리닝 모듈 추가하기

## 📋 준비된 파일
- `CompanyNameCleaning.bas` - VBA 모듈 파일
- `기업명_클리닝_로직_설명.md` - 로직 설명 문서

## 🔧 설치 방법

### 1단계: Personal.xlsb 열기
1. Excel을 실행합니다
2. `Alt + F11`을 눌러 VBA 편집기를 엽니다
3. 왼쪽 프로젝트 탐색기에서 `VBAProject (PERSONAL.XLSB)`를 찾습니다
   - 만약 PERSONAL.XLSB가 없다면:
     - Excel로 돌아가서 `보기` → `매크로` → `매크로 기록` 클릭
     - "개인용 매크로 통합 문서에 저장" 선택
     - 즉시 기록 중지
     - 다시 `Alt + F11`로 VBA 편집기 열기

### 2단계: 모듈 가져오기
1. VBA 편집기에서 `VBAProject (PERSONAL.XLSB)` 우클릭
2. `파일 가져오기` 선택
3. `d:\git_rk\vba\CompanyNameCleaning.bas` 파일 선택
4. `열기` 클릭

### 3단계: 확인
1. 프로젝트 탐색기에서 `VBAProject (PERSONAL.XLSB)` → `모듈` → `CompanyNameCleaning` 확인
2. 모듈을 더블클릭하여 코드가 정상적으로 임포트되었는지 확인

### 4단계: 저장
1. `Ctrl + S` 또는 저장 버튼 클릭
2. VBA 편집기 닫기

## 🚀 사용 방법

### 방법 1: 기업명 클리닝
1. Excel에서 클리닝할 기업명이 있는 셀들을 선택
2. `Alt + F8`을 눌러 매크로 대화상자 열기
3. `CleanCompanyNames` 선택 후 실행
4. 선택한 셀의 오른쪽 열에 클리닝된 기업명이 표시됩니다

### 방법 2: 중복 검사
1. Excel에서 검사할 기업명이 있는 셀들을 선택
2. `Alt + F8`을 눌러 매크로 대화상자 열기
3. `CheckDuplicates` 선택 후 실행
4. 중복된 기업명 목록이 메시지 박스로 표시됩니다

### 빠른 실행 버튼 추가 (선택사항)
1. Excel 리본 메뉴에서 `파일` → `옵션` → `빠른 실행 도구 모음`
2. "다음에서 명령 선택" → `매크로` 선택
3. `PERSONAL.XLSB!CleanCompanyNames` 선택 후 `추가` 클릭
4. 필요시 `PERSONAL.XLSB!CheckDuplicates`도 추가
5. `확인` 클릭

## 📊 처리 예시

| 원본 기업명 | 클리닝 결과 |
|------------|-----------|
| 주식회사 삼성전자 | 삼성전자 |
| 삼성전자(주) | 삼성전자 |
| (주)삼성전자 본사 | 삼성전자 |
| ㈜현대자동차 울산공장 | 현대자동차 |
| LG전자 주식회사 | LG전자 |
| SK하이닉스(주)(본사) | SK하이닉스 |

## 🔍 주요 기능

### CleanCompanyNames
- **기능**: 선택된 기업명을 표준화된 형식으로 클리닝
- **입력**: 선택된 셀 범위
- **출력**: 선택 영역 오른쪽 열에 클리닝된 기업명 표시

### CheckDuplicates
- **기능**: 클리닝 후 중복되는 기업명 검사
- **입력**: 선택된 셀 범위
- **출력**: 중복 기업명 목록 메시지 박스

## 🛠️ 클리닝 처리 항목

1. ✅ 영문 법인 형태 제거 (Co., Ltd., Inc., LLC 등)
2. ✅ 한글 법인 형태 제거 (주식회사, 유한회사, 재단법인 등)
3. ✅ 법인 약어 제거 ((주), ㈜, (유) 등)
4. ✅ 괄호 안 내용 제거 (본사), (공장), (지점) 등)
5. ✅ 사업장 관련 단어 제거 (본사, 지점, 공장, 센터 등)
6. ✅ 지역명 제거 (서울, 부산, 울산 등)
7. ✅ 특수문자 제거
8. ✅ 모든 공백 제거

## ⚠️ 주의사항

- Personal.xlsb는 Excel이 실행될 때마다 자동으로 로드됩니다
- 모든 Excel 파일에서 이 매크로를 사용할 수 있습니다
- 원본 데이터는 변경되지 않고, 오른쪽 열에 결과가 추가됩니다
- 필요시 `RemoveUnnecessaryWords` 함수에서 제거할 단어를 추가/수정할 수 있습니다

## 🔄 업데이트 방법

1. `CompanyNameCleaning.bas` 파일을 수정
2. VBA 편집기에서 기존 `CompanyNameCleaning` 모듈 삭제
3. 위의 "2단계: 모듈 가져오기" 과정 반복
