# 마크다운 → HWPX 변환기 결과 리포트

> 작성일: 2026-02-18 16:41

---

## 1. 개요

마크다운(`.md`) 파일을 한글(`.hwpx`) 파일로 변환하는 범용 Python 모듈 `md_to_hwpx.py`를 개발하였습니다.

## 2. 결과 요약

| 항목        | 내용                                            |
| ----------- | ----------------------------------------------- |
| 입력 파일   | `건의사항_종합표.md`                            |
| 출력 파일   | `hwpx_output/건의사항_종합표_202602181641.hwpx` |
| 파싱된 요소 | 10개 (제목, 표 2개, 인용문, 수평선, 문단 등)    |
| 변환 방식   | `pyhwpx` COM 자동화 (한글 앱 제어)              |
| 저장 형식   | HWPX (한글 XML 기반 포맷)                       |

## 3. 모듈 구조

```
md_to_hwpx.py
├── MarkdownParser         # 마크다운 → 구조화 요소
│   ├── parse()            # 파일 읽기 + 파싱
│   ├── _parse_table()     # 표 파싱 (헤더/데이터/정렬)
│   └── _parse_content()   # 전체 요소 분류
│
├── HwpxWriter             # 구조화 요소 → HWPX
│   ├── write()            # 메인 변환 로직
│   ├── _write_heading()   # 제목 (6단계, 볼드, 크기)
│   ├── _write_table()     # 표 (헤더 볼드, 셀 정렬)
│   ├── _write_blockquote()# 인용문 (이탤릭, 들여쓰기)
│   └── _save()            # 타임스탬프 파일명 저장
│
├── convert()              # 원스톱 변환 함수
└── main()                 # CLI 진입점
```

## 4. 사용법

### 방법 1: CLI (명령줄)

```bash
# 기본 사용 (백그라운드 실행, 자동 파일명)
python md_to_hwpx.py "입력파일.md"

# 한글 앱 화면에 표시하면서 실행
python md_to_hwpx.py "입력파일.md" --visible

# 출력 경로 직접 지정
python md_to_hwpx.py "입력파일.md" --output "결과.hwpx"
```

### 방법 2: Python 코드에서 import

```python
from md_to_hwpx import convert

# 기본 사용
result = convert("건의사항_종합표.md")
print(f"저장됨: {result}")

# 옵션 지정
result = convert(
    input_path="input.md",
    output_path="output/결과.hwpx",  # 경로 지정 (None이면 자동)
    visible=True                     # 한글 앱 표시
)
```

### 출력 경로 규칙

| 항목        | 규칙                                          |
| ----------- | --------------------------------------------- |
| 저장 위치   | 입력 파일 디렉토리의 `hwpx_output/` 하위 폴더 |
| 파일명 형식 | `{원본파일명}_{YYYYMMDDHHmm}.hwpx`            |
| 예시        | `건의사항_종합표_202602181641.hwpx`           |

## 5. 지원하는 마크다운 요소

| 요소             | 변환 결과                                             |
| ---------------- | ----------------------------------------------------- |
| `# 제목` (H1~H6) | 레벨별 글꼴 크기 (18~10pt), 볼드, H1-H2는 가운데 정렬 |
| `                | 표                                                    | ` | 한글 표 (헤더행 볼드, 셀 정렬 반영) |
| `> 인용문`       | 이탤릭 + 들여쓰기 + 회색 글자                         |
| `---` 수평선     | 빈 줄                                                 |
| 일반 문단        | 맑은 고딕 10pt                                        |
| `**볼드**`       | 서체에서 제거 (표 셀 내)                              |

## 6. 필수 조건

- **OS**: Windows
- **한글**: 한글과컴퓨터 한/글 설치 필요
- **Python**: 3.9 이상
- **패키지**: `pyhwpx` (`pip install pyhwpx`)

## 7. 참고사항

- cmd에서 한글 파일명 사용 시 인코딩 문제가 발생할 수 있음 → Python 스크립트 내에서 `convert()` 직접 호출 또는 `chcp 65001` 후 실행 추천
- 변환 중 한글 앱이 백그라운드에서 실행됨 (`--visible` 옵션으로 확인 가능)
- 대용량 표가 있는 경우 변환 시간이 다소 걸릴 수 있음
