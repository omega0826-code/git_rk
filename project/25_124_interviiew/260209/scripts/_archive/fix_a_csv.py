# -*- coding: utf-8 -*-
import csv, os

CSV_DIR = r"d:\git_rk\project\25_124_interviiew\260209\REPORT\csv_tables"

def save(filename, header, rows):
    fp = os.path.join(CSV_DIR, filename)
    with open(fp, "w", encoding="utf-8-sig", newline="") as f:
        w = csv.writer(f)
        w.writerow(header)
        for r in rows:
            w.writerow(r)
    print(f"OK: {fp}")

# 1-1 선호시간대
save("01_group_A_1-1_선호시간대.csv",
    ["구분","합계","오후(13~17시)_기업수","오후(13~17시)_비율","상관없음_기업수","상관없음_비율","퇴근 후(18시~)_기업수","퇴근 후(18시~)_비율","주말_기업수","주말_비율","온라인(시간무관)_기업수","온라인(시간무관)_비율"],
    [
        ["전체",21,9,"42.9%",5,"23.8%",2,"9.5%",3,"14.3%",2,"9.5%"],
        ["제조업",14,6,"42.9%",3,"21.4%",2,"14.3%",2,"14.3%",1,"7.1%"],
        ["건설업",2,1,"50.0%",1,"50.0%",0,"0.0%",0,"0.0%",0,"0.0%"],
        ["서비스업",1,0,"0.0%",0,"0.0%",0,"0.0%",1,"100%",0,"0.0%"],
        ["기타업",3,2,"66.7%",1,"33.3%",0,"0.0%",0,"0.0%",1,"33.3%"],
    ])

# 1-2 회피시기
save("01_group_A_1-2_회피시기.csv",
    ["구분","합계","연초연말_기업수","연초연말_비율","월요일_기업수","월요일_비율","주말_기업수","주말_비율","월초월말_기업수","월초월말_비율","금요일_기업수","금요일_비율"],
    [
        ["전체",21,8,"38.1%",4,"19.0%",4,"19.0%",2,"9.5%",1,"4.8%"],
        ["제조업",14,7,"50.0%",4,"28.6%",4,"28.6%",1,"7.1%",0,"0.0%"],
        ["건설업",2,0,"0.0%",0,"0.0%",0,"0.0%",1,"50.0%",0,"0.0%"],
        ["서비스업",1,1,"100%",0,"0.0%",0,"0.0%",0,"0.0%",0,"0.0%"],
        ["기타업",3,0,"0.0%",0,"0.0%",0,"0.0%",0,"0.0%",1,"33.3%"],
    ])

# 2-1 애로사항
save("01_group_A_2-1_애로사항.csv",
    ["구분","합계","시간확보어려움_기업수","시간확보어려움_비율","참여도저조_기업수","참여도저조_비율","대체인력부족_기업수","대체인력부족_비율","콘텐츠부적합_기업수","콘텐츠부적합_비율","비용인센티브_기업수","비용인센티브_비율","교통접근성_기업수","교통접근성_비율","없음_기업수","없음_비율"],
    [
        ["전체",21,12,"57.1%",7,"33.3%",4,"19.0%",5,"23.8%",4,"19.0%",2,"9.5%",2,"9.5%"],
        ["제조업",14,8,"57.1%",5,"35.7%",3,"21.4%",3,"21.4%",3,"21.4%",1,"7.1%",1,"7.1%"],
        ["건설업",2,1,"50.0%",0,"0.0%",0,"0.0%",0,"0.0%",0,"0.0%",1,"50.0%",1,"50.0%"],
        ["서비스업",1,1,"100%",0,"0.0%",1,"100%",0,"0.0%",1,"100%",0,"0.0%",0,"0.0%"],
        ["기타업",3,2,"66.7%",2,"66.7%",0,"0.0%",2,"66.7%",0,"0.0%",0,"0.0%",0,"0.0%"],
    ])

print("A group CSV fix done!")
