# 한글 인코딩 문제 해결 가이드

## 🔍 문제 상황

HTML 지도에서 한글이 깨져서 표시됨:
```
AREA_CD:	POI068
CATEGORY:	諛쒕떊긽沅
AREA_NM:	꽦닔移댄럹嫄곕━
```

**원인**: Shapefile 읽기 시 잘못된 인코딩 사용

---

## ✅ 수정 내용

### 1. 인코딩 자동 감지 기능 추가

`map_visualization.py` 스크립트를 수정하여 여러 인코딩을 자동으로 시도:

```python
# 여러 인코딩 시도
encodings_to_try = ['utf-8', 'euc-kr', 'cp949']

for encoding in encodings_to_try:
    try:
        gdf = gpd.read_file(shp_path, encoding=encoding)
        print(f"✓ 로드 완료 (인코딩: {encoding})")
        break
    except:
        continue
```

### 2. CPG 파일 확인

Shapefile의 `.cpg` 파일에는 인코딩 정보가 저장되어 있습니다.

---

## 🚀 해결 방법

### 방법 1: 수정된 스크립트 재실행 (추천)

```bash
cd d:\git_rk
python map_visualization.py
```

수정된 스크립트가 자동으로 올바른 인코딩을 찾아서 적용합니다.

---

### 방법 2: CPG 파일 수정 (필요시)

CPG 파일 내용을 확인하고 필요시 수정:

**현재 CPG 파일 위치**:
```
d:\git_rk\data\서울시 상권\서울시 주요 82장소 영역\서울시 주요 82장소 영역.cpg
```

**올바른 내용**:
- `UTF-8` 또는
- `EUC-KR`

메모장으로 열어서 확인하고, 필요시 수정하세요.

---

## 📋 재실행 단계

### 1단계: 기존 HTML 파일 백업 (선택)
```bash
cd d:\git_rk\output
copy 서울시_82장소_지도.html 서울시_82장소_지도_백업.html
```

### 2단계: 스크립트 재실행
```bash
cd d:\git_rk
python map_visualization.py
```

### 3단계: 결과 확인
- 브라우저에서 `d:\git_rk\output\서울시_82장소_지도.html` 다시 열기
- 한글이 정상적으로 표시되는지 확인

**정상 표시 예시**:
```
AREA_CD:	POI068
CATEGORY:	발달상권
AREA_NM:	성수카페거리
```

---

## 🔧 추가 문제 해결

### 한글이 여전히 깨지는 경우

#### 1. 인코딩 순서 변경
`map_visualization.py` 파일을 열어서 32번째 줄 수정:

```python
# 현재
encodings_to_try = ['utf-8', 'euc-kr', 'cp949']

# 변경 (euc-kr을 먼저 시도)
encodings_to_try = ['euc-kr', 'utf-8', 'cp949']
```

#### 2. 특정 인코딩 강제 지정
확실한 인코딩을 알고 있다면 직접 지정:

```python
# 32-50번째 줄을 다음으로 교체
gdf = gpd.read_file(shp_path, encoding='euc-kr')
print(f"  ✓ 로드 완료: {len(gdf)}개 영역")
```

---

## 📊 예상 결과

### 수정 전
```
CATEGORY:	諛쒕떊긽沅
AREA_NM:	꽦닔移댄럹嫄곕━
```

### 수정 후
```
CATEGORY:	발달상권
AREA_NM:	성수카페거리
```

---

## ✨ 완료 확인

재실행 후 다음을 확인하세요:

1. ✅ 터미널에 "✓ 로드 완료 (인코딩: utf-8)" 또는 유사한 메시지 표시
2. ✅ HTML 파일 크기가 비슷함 (약 580KB)
3. ✅ 브라우저에서 열었을 때 한글이 정상 표시
4. ✅ 영역 클릭 시 팝업의 한글이 정상 표시

---

## 📞 추가 지원

문제가 계속되면 다음 정보를 제공해주세요:
1. 터미널 출력 메시지
2. CPG 파일 내용
3. 한글이 깨진 스크린샷
