# 의원급 피부과 입지 분석을 위한 EDA 실행 가이드라인

**작성일**: 2026-02-03  
**버전**: 3.03 (무한 로딩 근본 원인 해결)  
**데이터 기준**: 강남구 주요 82장소 상권 데이터 (2022년 1분기 ~ 2024년 4분기)  
**분석 목적**: 의원급 피부과 최적 입지 선정을 위한 탐색적 데이터 분석

---

## 📋 변경 이력

### v3.03 (2026-02-03)
- 🔧 **무한 로딩 근본 원인 해결**
  - `koreanize_matplotlib` 초기화 전후 상태 메시지 추가 (30-60초 소요 안내)
  - CSV 로딩 시 실시간 진행 상태 표시 (파일별 행/열 수 출력)
  - 모든 출력에 `flush=True` 적용하여 버퍼링 지연 제거
  - 디렉토리 생성 및 전처리 단계 가시화
- ✅ 통합 실행 스크립트(`99_전체실행.py`) 생성
- 📝 트러블슈팅 섹션 신규 추가
- 📊 예상 실행 시간 가이드 추가

### v3.02 (2026-02-03)
- 🚀 **분석 속도 최적화 및 무한 로딩 방지**
  - 테스트 코드 및 중간 저장(`to_csv`) 로직 대폭 제거
  - 불필요한 콘솔 출력을 최소화하고 핵심 분석 지표 중심 실행
  - 한글 폰트 설정 캐싱 및 예외 처리 강화
- ✅ 전체 실행 스크립트(`99_전체실행.py`) 가이드 보완

### v3.01 (2026-02-03)
- ✅ 데이터 로딩 스크립트 무한 로딩 오류 수정

---

## ⚠️ 무한 로딩 방지 가이드라인 (중요)

스크립트 실행 시 응답 없음 상태가 발생하는 것을 방지하기 위해 다음 원칙을 준수합니다.

### 적용된 해결책

#### 1. **진행 상태 가시화** ✅
모든 주요 단계(폰트 설정, 디렉토리 생성, CSV 로딩, 전처리)에서 시작/완료 메시지를 출력합니다.

**예상 출력 예시**:
```
[1/3] 한글 폰트 설정 중... ✓ 완료
[2/4] 산출물 디렉토리 생성 중... ✓ 완료
[3/4] 데이터 로딩 중 (총 8개 파일)...
  [1/8] 영역-상권        로딩 중... ✓ (82행, 15열)
  [2/8] 점포-상권        로딩 중... ✓ (8,234행, 12열)
  ...
[4/4] 데이터 전처리 중 (날짜 변환)... ✓ 완료
```

#### 2. **출력 버퍼 플러시 강제** ✅
모든 `print()` 문에 `flush=True` 파라미터를 추가하여 실시간 출력을 보장합니다.

#### 3. **중간 저장 최소화** ✅
분석 중간 단계에서의 파일 저장(`df.to_csv`)을 제거하고 최종 결과물만 저장합니다.

#### 4. **폰트 로딩 최적화** ✅
`koreanize_matplotlib` 초기화 시간(30-60초)을 사용자에게 명확히 안내하고, 실패 시 즉시 대체 폰트로 전환합니다.

### 예상 실행 시간

| 단계                 | 예상 소요 시간 | 비고                          |
| -------------------- | -------------- | ----------------------------- |
| 한글 폰트 설정       | 30-60초        | `koreanize_matplotlib` 초기화 |
| 디렉토리 생성        | 1초 미만       |                               |
| CSV 로딩 (8개 파일)  | 30-60초        | 각 파일 50MB+                 |
| 데이터 전처리        | 5-10초         | 날짜 변환                     |
| **전체 데이터 로딩** | **약 90초**    |                               |

---

## 2. 산출물 디렉토리 구조

분석 결과는 다음과 같은 **분석 주제별 디렉토리 구조**로 저장됩니다:

```
REPORT/
├── 00_스크립트/
│   ├── 01_데이터로딩.py                # 초기 설정 및 데이터 로딩 (모듈형)
│   ├── 02_경쟁환경분석.py              # 시장 규모 및 경쟁 강도 분석
│   ├── 03_고객분석.py                  # 타겟 고객 매출 및 패턴 분석
│   ├── 04_인구유동분석.py              # 인구 구조 및 유동인구 분석
│   ├── 05_입지조건분석.py              # 접근성, 인프라, 소비력 분석
│   ├── 06_종합평가.py                  # 지표 통합 및 최종 입지 추천
│   └── 99_전체실행.py                  # 파이프라인 일괄 실행 (권장)
│
├── 01_경쟁환경분석/
├── 02_고객분석/
├── 03_인구유동분석/
├── 04_입지조건분석/
├── 05_종합평가/
└── 06_최종리포트/
```

---

## 4. 단계별 EDA 실행

### [권장] 전체 통합 실행

개별 스크립트 실행 시의 번거로움과 중복 로딩을 피하기 위해 **통합 실행 스크립트 사용을 강력히 권장**합니다.

#### 실행 방법

```bash
cd "d:\git_rk\data\서울시 주요 82장소 영역\REPORT\00_스크립트"
python 99_전체실행.py
```

#### 예상 출력

```
================================================================================
🏥 의원급 피부과 입지 분석 - 전체 파이프라인 실행
================================================================================
시작 시간: 2026-02-03 17:30:00
================================================================================

▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶
📂 [단계 1/6] 데이터 로딩 및 준비
▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶▶

[1/3] 한글 폰트 설정 중... ✓ 완료
[2/4] 산출물 디렉토리 생성 중... ✓ 완료
[3/4] 데이터 로딩 중 (총 8개 파일)...
  [1/8] 영역-상권        로딩 중... ✓ (82행, 15열)
  ...
[4/4] 데이터 전처리 중 (날짜 변환)... ✓ 완료

✅ 단계 1 완료 (소요 시간: 90.2초)

[단계 2-6은 향후 구현 예정]

================================================================================
🎉 전체 파이프라인 실행 완료!
================================================================================
총 소요 시간: 95.3초 (1.6분)
```

---

### 개별 스크립트 실행 (선택사항)

> [!WARNING]
> 개별 스크립트를 실행할 경우 각 스크립트마다 데이터를 중복 로딩하게 되어 비효율적입니다.
> 가능한 한 `99_전체실행.py`를 사용하세요.

#### 4.1 데이터 로딩 및 준비 (01_데이터로딩.py)

```bash
python 01_데이터로딩.py
```

- 데이터를 메모리에 로드하고 공통 전처리(날짜 변환 등)를 수행합니다.
- **V3.03 변경사항**: 모든 단계에서 진행 상태를 실시간으로 표시합니다.

#### 4.2 경쟁 환경 분석 (02_경쟁환경분석.py)
- '일반의원' 업종을 기준으로 점포 수, 개업률, 폐업률을 분석합니다.
- 상권별 경쟁 강도를 지수로 산출합니다.

#### 4.3 고객 및 매출 분석 (03_고객분석.py)
- 타겟 고객(20~40대 여성)의 매출 비중이 높은 상권을 식별합니다.
- 요일별/시간대별 매출 패턴을 추출하여 운영 전략 기초 자료를 생성합니다.

#### 4.4 인구 및 유동량 분석 (04_인구유동분석.py)
- 직장인구 밀집도와 유동인구의 상관관계를 분석합니다.
- 배후 수요의 안정성을 평가합니다.

#### 4.5 입지 및 인프라 평가 (05_입지조건분석.py)
- 지하철역 접근성과 반경 내 의료 시설(약국 등) 현황을 분석합니다.
- 소득 수준 대비 의료비 지출 성향을 확인합니다.

#### 4.6 종합 평가 및 보고서 생성 (06_종합평가.py)
- 위 모든 분석 결과를 통합하여 '입지 적합도 스코어'를 산출합니다.
- 최종 추천 상권 Top 3를 제안합니다.

---

## 🔧 트러블슈팅

### 증상 1: 폰트 설정 단계에서 30초 이상 멈춤

**원인**: `koreanize_matplotlib` 라이브러리가 시스템 폰트를 스캔하는 중입니다.

**해결**: 
- ✅ **정상 동작**입니다. "✓ 완료" 메시지가 나올 때까지 기다려주세요.
- 최대 60초 소요될 수 있습니다.
- 라이브러리가 설치되지 않은 경우 자동으로 대체 폰트(Malgun Gothic)로 전환됩니다.

---

### 증상 2: CSV 로딩 중 응답 없음

**원인**: 대용량 파일(각 50MB+) 8개를 순차적으로 로딩하는 중입니다.

**해결**:
- ✅ **정상 동작**입니다. 각 파일별 진행 메시지를 확인하세요.
- 예시: `[3/8] 추정매출-상권 로딩 중... ✓ (12,345행, 20열)`
- 전체 로딩에 30-60초 소요됩니다.

---

### 증상 3: 진행 메시지가 전혀 출력되지 않음

**원인**: 
1. Python 경로 문제
2. 터미널 출력 버퍼 문제
3. 스크립트 파일 손상

**해결**:
1. Python 버전 확인:
   ```bash
   python --version
   ```
   (Python 3.8 이상 권장)

2. 로그 파일로 리다이렉트하여 실행:
   ```bash
   python 01_데이터로딩.py > debug_log.txt 2>&1
   ```
   실행 후 `debug_log.txt` 파일을 열어 오류 메시지 확인

3. 필수 라이브러리 설치 확인:
   ```bash
   pip install pandas numpy matplotlib seaborn koreanize-matplotlib
   ```

---

### 증상 4: ImportError 또는 ModuleNotFoundError

**원인**: 필수 라이브러리가 설치되지 않았습니다.

**해결**:
```bash
pip install pandas numpy matplotlib seaborn koreanize-matplotlib
```

---

## 💡 추가 권장사항

### 성능 최적화
- **메모리**: 최소 8GB RAM 권장 (대용량 CSV 처리)
- **저장공간**: 최소 1GB 여유 공간 확보 (산출물 저장)

### 데이터 경로 변경
현재 스크립트는 다음 경로를 하드코딩하고 있습니다:
```python
data_path = 'd:/git_rk/data/서울시 주요 82장소 영역/Gangnam_CSV_20260203_094620/'
```

다른 환경에서 실행 시 `01_데이터로딩.py` 파일의 39번 라인을 수정하세요.

---

> [!NOTE]
> 모든 분석 스크립트는 `REPORT/00_스크립트/` 내에 위치하며, 실행 결과인 CSV와 PNG 파일은 각각의 주제별 폴더에 자동 저장됩니다.

> [!TIP]
> 처음 실행하는 경우 `99_전체실행.py`를 사용하여 전체 파이프라인을 한 번에 실행하는 것을 권장합니다. 개별 단계별 분석이 필요한 경우에만 개별 스크립트를 실행하세요.
