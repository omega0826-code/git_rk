# 의원급 피부과 입지 분석을 위한 EDA 실행 가이드라인

**작성일**: 2026-02-03  
**데이터 기준**: 강남구 주요 82장소 상권 데이터 (2022년 1분기 ~ 2024년 4분기)  
**분석 목적**: 의원급 피부과 최적 입지 선정을 위한 탐색적 데이터 분석

---

## 1. 데이터 개요

### 1.1 사용 가능한 데이터셋

강남구 5개 주요 상권(양재역, 가로수길, 강남역, 역삼역, 선릉역)에 대한 9개 CSV 파일:

| 파일명 | 주요 내용 | 활용도 |
|--------|----------|--------|
| `영역-상권.csv` | 상권 기본정보 (좌표, 면적, 행정구역) | ★★★ |
| `점포-상권.csv` | 업종별 점포 수, 개폐업률 (분기별) | ★★★★★ |
| `추정매출-상권.csv` | 업종별 매출액/건수, 시간대/요일/연령대별 분석 | ★★★★★ |
| `상주인구-상권.csv` | 거주 인구 통계 (성별, 연령대별) | ★★★★ |
| `직장인구-상권.csv` | 직장 인구 통계 (성별, 연령대별) | ★★★★ |
| `소득소비-상권.csv` | 월평균 소득, 지출 패턴 | ★★★★ |
| `집객시설-상권.csv` | 지하철역, 버스 정거장, 은행, 약국 등 집객시설 | ★★★★ |
| `길단위인구-상권.csv` | 유동인구 데이터 | ★★★ |
| `상권변화지표-상권.csv` | 상권 활성화 지표 | ★★★ |

---

## 2. 피부과 입지 분석 핵심 변수

### 2.1 경쟁 환경 분석 (점포-상권 데이터)

> [!IMPORTANT]
> 피부과는 `서비스_업종_코드` **CS200006 (일반의원)** 카테고리에 포함됨

#### 주요 분석 변수
- **점포_수**: 현재 일반의원 수 (경쟁 강도)
- **개업_율 / 개업_점포_수**: 신규 진입 추세
- **폐업_률 / 폐업_점포_수**: 시장 안정성 지표
- **프랜차이즈_점포_수**: 대형 체인 의원 현황

#### 분석 방법
```python
# 1. 상권별 일반의원 경쟁 강도 비교
competition_analysis = df_stores[
    df_stores['서비스_업종_코드'] == 'CS200006'
].groupby('상권_코드_명').agg({
    '점포_수': 'mean',
    '개업_율': 'mean',
    '폐업_률': 'mean'
})

# 2. 시계열 트렌드 분석 (2022Q1 ~ 2024Q4)
trend_analysis = df_stores[
    df_stores['서비스_업종_코드'] == 'CS200006'
].pivot_table(
    index='기준_년분기_코드',
    columns='상권_코드_명',
    values='점포_수'
)
```

### 2.2 타겟 고객층 분석 (추정매출 데이터)

#### 피부과 주요 타겟층
1. **여성 고객** (피부 관리 수요 높음)
2. **20~40대** (미용 관심도 높은 연령층)
3. **평일 낮 시간대** (직장인 점심시간, 주부 오후 시간)

#### 주요 분석 변수
- **여성_매출_금액 / 여성_매출_건수**: 여성 고객 비중
- **연령대_20_매출_금액 ~ 연령대_40_매출_금액**: 주요 타겟 연령대 소비력
- **시간대_11~14_매출_금액**: 점심시간 유동 인구
- **주중_매출_금액 vs 주말_매출_금액**: 평일/주말 패턴

#### 분석 방법
```python
# 1. 상권별 타겟층 매출 비중 계산
target_customer_analysis = df_sales[
    df_sales['서비스_업종_코드'] == 'CS200006'
].copy()

target_customer_analysis['여성_비중'] = (
    target_customer_analysis['여성_매출_금액'] / 
    target_customer_analysis['당월_매출_금액'] * 100
)

target_customer_analysis['2040대_비중'] = (
    (target_customer_analysis['연령대_20_매출_금액'] + 
     target_customer_analysis['연령대_30_매출_금액'] + 
     target_customer_analysis['연령대_40_매출_금액']) / 
    target_customer_analysis['당월_매출_금액'] * 100
)

# 2. 상권별 집계
target_summary = target_customer_analysis.groupby('상권_코드_명').agg({
    '여성_비중': 'mean',
    '2040대_비중': 'mean',
    '당월_매출_금액': 'mean'
})
```

### 2.3 인구 구조 분석

#### 상주인구 (거주민)
```python
# 여성 20~40대 거주 인구 비중
resident_analysis = df_resident.copy()
resident_analysis['여성2040대_인구'] = (
    resident_analysis['여성연령대_20_상주인구_수'] +
    resident_analysis['여성연령대_30_상주인구_수'] +
    resident_analysis['여성연령대_40_상주인구_수']
)
resident_analysis['여성2040대_비중'] = (
    resident_analysis['여성2040대_인구'] / 
    resident_analysis['총_상주인구_수'] * 100
)
```

#### 직장인구 (유동 고객)
```python
# 여성 20~40대 직장 인구 비중
worker_analysis = df_worker.copy()
worker_analysis['여성2040대_직장인구'] = (
    worker_analysis['여성연령대_20_직장_인구_수'] +
    worker_analysis['여성연령대_30_직장_인구_수'] +
    worker_analysis['여성연령대_40_직장_인구_수']
)
worker_analysis['여성2040대_비중'] = (
    worker_analysis['여성2040대_직장인구'] / 
    worker_analysis['총_직장_인구_수'] * 100
)
```

### 2.4 접근성 분석 (집객시설 데이터)

> [!IMPORTANT]
> 대중교통 접근성은 피부과 방문 편의성과 직결되는 핵심 지표

#### 주요 분석 변수
- **지하철_역_수**: 상권 내 지하철역 개수 (환승역 포함)
- **버스_정거장_수**: 상권 내 버스 정류장 개수
- **약국_수**: 의료 관련 편의시설 (처방전 수령 편의성)
- **은행_수**: 상권 활성화 지표

#### 분석 방법
```python
# 1. 최신 분기 집객시설 데이터
latest_facilities = df_facilities[
    df_facilities['기준_년분기_코드'] == latest_quarter
].copy()

# 2. 접근성 점수 계산
latest_facilities['대중교통_접근성'] = (
    latest_facilities['지하철_역_수'] * 2 +  # 지하철 가중치 높게
    latest_facilities['버스_정거장_수']
)

print("\n상권별 대중교통 접근성")
print(latest_facilities[[
    '상권_코드_명', 
    '지하철_역_수', 
    '버스_정거장_수', 
    '대중교통_접근성',
    '약국_수',
    '은행_수'
]])

# 3. 시각화
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# 지하철역 수
latest_facilities.set_index('상권_코드_명')['지하철_역_수'].plot(
    kind='bar', ax=axes[0], color='#3498db'
)
axes[0].set_title('상권별 지하철역 수', fontsize=12, fontweight='bold')
axes[0].set_ylabel('역 수')
axes[0].set_xlabel('')
axes[0].grid(True, alpha=0.3, axis='y')

# 버스 정거장 수
latest_facilities.set_index('상권_코드_명')['버스_정거장_수'].plot(
    kind='bar', ax=axes[1], color='#2ecc71'
)
axes[1].set_title('상권별 버스 정거장 수', fontsize=12, fontweight='bold')
axes[1].set_ylabel('정거장 수')
axes[1].set_xlabel('')
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig(data_path + '../REPORT/대중교통_접근성_분석.png', dpi=300, bbox_inches='tight')
plt.show()
```

#### 접근성 해석 가이드
- **지하철역 2개 이상**: 환승역 또는 복합 상권 → 유동인구 많음
- **버스 정거장 10개 이상**: 버스 노선 다양 → 접근성 우수
- **약국 10개 이상**: 의료 인프라 집중 지역

### 2.5 소득 및 소비력 분석

#### 주요 분석 변수
- **월_평균_소득_금액**: 상권 소득 수준
- **의료비_지출_총금액**: 의료 서비스 지출 규모
- **생활용품_지출_총금액**: 미용/건강 관련 소비 성향

```python
# 상권별 소득 및 의료비 지출 분석
income_analysis = df_income.groupby('상권_코드_명').agg({
    '월_평균_소득_금액': 'mean',
    '의료비_지출_총금액': 'mean',
    '지출_총금액': 'mean'
})

income_analysis['의료비_지출_비중'] = (
    income_analysis['의료비_지출_총금액'] / 
    income_analysis['지출_총금액'] * 100
)
```

---

## 3. 단계별 EDA 실행 프로세스

### 3.1 데이터 로딩 및 전처리

> [!NOTE]
> 집객시설 데이터를 추가로 로딩하여 접근성 분석에 활용

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from matplotlib import font_manager, rc

# 한글 폰트 설정
import koreanize_matplotlib

# 데이터 로딩
data_path = 'd:/git_rk/data/서울시 주요 82장소 영역/Gangnam_CSV_20260203_094620/'

df_area = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(영역-상권).csv', encoding='utf-8')
df_stores = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(점포-상권)_2022년 1분기~2024년 4분기.csv', encoding='utf-8')
df_sales = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(추정매출-상권)__2022년 1분기~2024년 4분기.csv', encoding='utf-8')
df_resident = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(상주인구-상권).csv', encoding='utf-8')
df_worker = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(직장인구-상권).csv', encoding='utf-8')
df_income = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(소득소비-상권).csv', encoding='utf-8')
df_facilities = pd.read_csv(data_path + 'gangnam_서울시 상권분석서비스(집객시설-상권).csv', encoding='utf-8')

# 기준년분기 데이터 타입 변환
for df in [df_stores, df_sales, df_resident, df_worker, df_income, df_facilities]:
    df['기준_년분기_코드'] = df['기준_년분기_코드'].astype(str)
    df['년도'] = df['기준_년분기_코드'].str[:4].astype(int)
    df['분기'] = df['기준_년분기_코드'].str[4:].astype(int)

print("데이터 로딩 완료")
print(f"상권 수: {df_area.shape[0]}")
print(f"점포 데이터: {df_stores.shape[0]} rows")
print(f"매출 데이터: {df_sales.shape[0]} rows")
```

### 3.2 Step 1: 경쟁 환경 분석

```python
# 1-1. 일반의원(피부과 포함) 경쟁 현황
medical_stores = df_stores[df_stores['서비스_업종_코드'] == 'CS200006'].copy()

# 최신 분기 데이터 (2024Q1)
latest_quarter = medical_stores['기준_년분기_코드'].max()
medical_latest = medical_stores[medical_stores['기준_년분기_코드'] == latest_quarter]

print("=" * 60)
print("상권별 일반의원 경쟁 현황 (2024년 1분기)")
print("=" * 60)
print(medical_latest[['상권_코드_명', '점포_수', '개업_율', '폐업_률', '프랜차이즈_점포_수']])

# 1-2. 시계열 트렌드 시각화
plt.figure(figsize=(12, 6))
for location in medical_stores['상권_코드_명'].unique():
    location_data = medical_stores[medical_stores['상권_코드_명'] == location]
    plt.plot(location_data['기준_년분기_코드'], 
             location_data['점포_수'], 
             marker='o', 
             label=location)

plt.title('상권별 일반의원 점포 수 추이 (2022Q1 ~ 2024Q4)', fontsize=14, fontweight='bold')
plt.xlabel('기준 년분기')
plt.ylabel('점포 수')
plt.legend()
plt.grid(True, alpha=0.3)
plt.xticks(rotation=45)
plt.tight_layout()
plt.savefig(data_path + '../REPORT/의원_점포수_추이.png', dpi=300, bbox_inches='tight')
plt.show()

# 1-3. 개폐업률 분석
churn_analysis = medical_stores.groupby('상권_코드_명').agg({
    '개업_율': 'mean',
    '폐업_률': 'mean',
    '점포_수': 'mean'
}).round(2)

print("\n상권별 평균 개폐업률")
print(churn_analysis)
```

### 3.3 Step 2: 타겟 고객층 매출 분석

```python
# 2-1. 일반의원 매출 데이터 추출
medical_sales = df_sales[df_sales['서비스_업종_코드'] == 'CS200006'].copy()

# 2-2. 타겟층 비중 계산
medical_sales['여성_매출_비중'] = (
    medical_sales['여성_매출_금액'] / medical_sales['당월_매출_금액'] * 100
)

medical_sales['20대_매출_비중'] = (
    medical_sales['연령대_20_매출_금액'] / medical_sales['당월_매출_금액'] * 100
)

medical_sales['30대_매출_비중'] = (
    medical_sales['연령대_30_매출_금액'] / medical_sales['당월_매출_금액'] * 100
)

medical_sales['40대_매출_비중'] = (
    medical_sales['연령대_40_매출_금액'] / medical_sales['당월_매출_금액'] * 100
)

medical_sales['2040대_매출_비중'] = (
    medical_sales['20대_매출_비중'] + 
    medical_sales['30대_매출_비중'] + 
    medical_sales['40대_매출_비중']
)

# 2-3. 상권별 타겟층 분석
target_summary = medical_sales.groupby('상권_코드_명').agg({
    '당월_매출_금액': 'mean',
    '여성_매출_비중': 'mean',
    '2040대_매출_비중': 'mean',
    '20대_매출_비중': 'mean',
    '30대_매출_비중': 'mean',
    '40대_매출_비중': 'mean'
}).round(2)

print("\n" + "=" * 60)
print("상권별 일반의원 타겟 고객층 매출 분석")
print("=" * 60)
print(target_summary)

# 2-4. 시간대별 매출 분석
time_columns = [
    '시간대_00~06_매출_금액',
    '시간대_06~11_매출_금액',
    '시간대_11~14_매출_금액',
    '시간대_14~17_매출_금액',
    '시간대_17~21_매출_금액',
    '시간대_21~24_매출_금액'
]

medical_sales_latest = medical_sales[medical_sales['기준_년분기_코드'] == latest_quarter]

time_analysis = medical_sales_latest.groupby('상권_코드_명')[time_columns].mean()

# 시간대별 매출 비중 계산
for col in time_columns:
    time_analysis[col + '_비중'] = (
        time_analysis[col] / time_analysis[time_columns].sum(axis=1) * 100
    )

print("\n상권별 시간대별 매출 비중 (%)")
print(time_analysis[[col + '_비중' for col in time_columns]].round(2))

# 2-5. 시각화: 상권별 타겟층 비중 비교
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# 여성 매출 비중
target_summary['여성_매출_비중'].plot(kind='bar', ax=axes[0], color='#FF6B9D')
axes[0].set_title('상권별 여성 매출 비중', fontsize=12, fontweight='bold')
axes[0].set_ylabel('비중 (%)')
axes[0].set_xlabel('')
axes[0].grid(True, alpha=0.3, axis='y')
axes[0].axhline(y=50, color='red', linestyle='--', alpha=0.5, label='50% 기준선')
axes[0].legend()

# 20~40대 매출 비중
target_summary['2040대_매출_비중'].plot(kind='bar', ax=axes[1], color='#4ECDC4')
axes[1].set_title('상권별 20~40대 매출 비중', fontsize=12, fontweight='bold')
axes[1].set_ylabel('비중 (%)')
axes[1].set_xlabel('')
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig(data_path + '../REPORT/타겟층_매출비중_비교.png', dpi=300, bbox_inches='tight')
plt.show()
```

### 3.4 Step 3: 인구 구조 분석

```python
# 3-1. 상주인구 분석
latest_resident = df_resident[df_resident['기준_년분기_코드'] == latest_quarter].copy()

latest_resident['여성2040대_인구'] = (
    latest_resident['여성연령대_20_상주인구_수'] +
    latest_resident['여성연령대_30_상주인구_수'] +
    latest_resident['여성연령대_40_상주인구_수']
)

latest_resident['여성2040대_비중'] = (
    latest_resident['여성2040대_인구'] / latest_resident['총_상주인구_수'] * 100
)

print("\n" + "=" * 60)
print("상권별 상주인구 분석")
print("=" * 60)
print(latest_resident[['상권_코드_명', '총_상주인구_수', '여성2040대_인구', '여성2040대_비중']])

# 3-2. 직장인구 분석
latest_worker = df_worker[df_worker['기준_년분기_코드'] == latest_quarter].copy()

latest_worker['여성2040대_직장인구'] = (
    latest_worker['여성연령대_20_직장_인구_수'] +
    latest_worker['여성연령대_30_직장_인구_수'] +
    latest_worker['여성연령대_40_직장_인구_수']
)

latest_worker['여성2040대_비중'] = (
    latest_worker['여성2040대_직장인구'] / latest_worker['총_직장_인구_수'] * 100
)

print("\n상권별 직장인구 분석")
print(latest_worker[['상권_코드_명', '총_직장_인구_수', '여성2040대_직장인구', '여성2040대_비중']])

# 3-3. 시각화: 인구 구조 비교
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# 상주인구 vs 직장인구
population_comparison = pd.DataFrame({
    '상주인구': latest_resident.set_index('상권_코드_명')['총_상주인구_수'],
    '직장인구': latest_worker.set_index('상권_코드_명')['총_직장_인구_수']
})

population_comparison.plot(kind='bar', ax=axes[0])
axes[0].set_title('상권별 상주인구 vs 직장인구', fontsize=12, fontweight='bold')
axes[0].set_ylabel('인구 수')
axes[0].set_xlabel('')
axes[0].legend()
axes[0].grid(True, alpha=0.3, axis='y')

# 여성 20~40대 비중 비교
target_pop_comparison = pd.DataFrame({
    '상주인구': latest_resident.set_index('상권_코드_명')['여성2040대_비중'],
    '직장인구': latest_worker.set_index('상권_코드_명')['여성2040대_비중']
})

target_pop_comparison.plot(kind='bar', ax=axes[1], color=['#FF6B9D', '#4ECDC4'])
axes[1].set_title('상권별 여성 20~40대 비중', fontsize=12, fontweight='bold')
axes[1].set_ylabel('비중 (%)')
axes[1].set_xlabel('')
axes[1].legend()
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig(data_path + '../REPORT/인구구조_비교.png', dpi=300, bbox_inches='tight')
plt.show()
```

### 3.5 Step 4: 접근성 분석

```python
# 4-1. 집객시설 데이터 추출
latest_facilities = df_facilities[df_facilities['기준_년분기_코드'] == latest_quarter].copy()

# 4-2. 대중교통 접근성 점수 계산
latest_facilities['대중교통_접근성'] = (
    latest_facilities['지하철_역_수'].fillna(0) * 2 +  # 지하철 가중치 2배
    latest_facilities['버스_정거장_수'].fillna(0)
)

print("\n" + "=" * 60)
print("상권별 대중교통 접근성 분석")
print("=" * 60)
print(latest_facilities[[
    '상권_코드_명', 
    '지하철_역_수', 
    '버스_정거장_수', 
    '대중교통_접근성',
    '약국_수',
    '은행_수',
    '일반_병원_수'
]])

# 4-3. 의료 인프라 분석
latest_facilities['의료_인프라_점수'] = (
    latest_facilities['일반_병원_수'].fillna(0) * 3 +
    latest_facilities['약국_수'].fillna(0)
)

print("\n상권별 의료 인프라")
print(latest_facilities[['상권_코드_명', '일반_병원_수', '약국_수', '의료_인프라_점수']])

# 4-4. 시각화
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# 지하철역 수
latest_facilities.set_index('상권_코드_명')['지하철_역_수'].plot(
    kind='bar', ax=axes[0, 0], color='#3498db'
)
axes[0, 0].set_title('상권별 지하철역 수', fontsize=12, fontweight='bold')
axes[0, 0].set_ylabel('역 수')
axes[0, 0].set_xlabel('')
axes[0, 0].grid(True, alpha=0.3, axis='y')

# 버스 정거장 수
latest_facilities.set_index('상권_코드_명')['버스_정거장_수'].plot(
    kind='bar', ax=axes[0, 1], color='#2ecc71'
)
axes[0, 1].set_title('상권별 버스 정거장 수', fontsize=12, fontweight='bold')
axes[0, 1].set_ylabel('정거장 수')
axes[0, 1].set_xlabel('')
axes[0, 1].grid(True, alpha=0.3, axis='y')

# 대중교통 접근성 종합
latest_facilities.set_index('상권_코드_명')['대중교통_접근성'].plot(
    kind='bar', ax=axes[1, 0], color='#9b59b6'
)
axes[1, 0].set_title('상권별 대중교통 접근성 종합 점수', fontsize=12, fontweight='bold')
axes[1, 0].set_ylabel('접근성 점수')
axes[1, 0].set_xlabel('')
axes[1, 0].grid(True, alpha=0.3, axis='y')

# 약국 수 (의료 편의성)
latest_facilities.set_index('상권_코드_명')['약국_수'].plot(
    kind='bar', ax=axes[1, 1], color='#e74c3c'
)
axes[1, 1].set_title('상권별 약국 수', fontsize=12, fontweight='bold')
axes[1, 1].set_ylabel('약국 수')
axes[1, 1].set_xlabel('')
axes[1, 1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig(data_path + '../REPORT/대중교통_접근성_분석.png', dpi=300, bbox_inches='tight')
plt.show()
```

### 3.6 Step 5: 소득 및 소비력 분석

```python
# 5-1. 소득 및 지출 분석
latest_income = df_income[df_income['기준_년분기_코드'] == latest_quarter].copy()

latest_income['의료비_지출_비중'] = (
    latest_income['의료비_지출_총금액'] / latest_income['지출_총금액'] * 100
)

print("\n" + "=" * 60)
print("상권별 소득 및 의료비 지출 분석")
print("=" * 60)
print(latest_income[['상권_코드_명', '월_평균_소득_금액', '의료비_지출_총금액', '의료비_지출_비중']])

# 5-2. 시각화
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# 월평균 소득
latest_income.set_index('상권_코드_명')['월_평균_소득_금액'].plot(
    kind='bar', ax=axes[0], color='#95E1D3'
)
axes[0].set_title('상권별 월평균 소득', fontsize=12, fontweight='bold')
axes[0].set_ylabel('소득 (원)')
axes[0].set_xlabel('')
axes[0].grid(True, alpha=0.3, axis='y')

# 의료비 지출 비중
latest_income.set_index('상권_코드_명')['의료비_지출_비중'].plot(
    kind='bar', ax=axes[1], color='#F38181'
)
axes[1].set_title('상권별 의료비 지출 비중', fontsize=12, fontweight='bold')
axes[1].set_ylabel('비중 (%)')
axes[1].set_xlabel('')
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig(data_path + '../REPORT/소득_의료비지출_분석.png', dpi=300, bbox_inches='tight')
plt.show()
```

### 3.7 Step 6: 종합 입지 평가 스코어링

```python
# 6-1. 평가 지표 통합
evaluation_df = pd.DataFrame()

# 경쟁 강도 (낮을수록 좋음 - 역수 사용)
competition_score = 1 / medical_latest.set_index('상권_코드_명')['점포_수']
evaluation_df['경쟁강도점수'] = (competition_score / competition_score.max() * 100)

# 타겟층 매출 비중 (높을수록 좋음)
evaluation_df['여성매출점수'] = (
    target_summary['여성_매출_비중'] / target_summary['여성_매출_비중'].max() * 100
)
evaluation_df['2040대매출점수'] = (
    target_summary['2040대_매출_비중'] / target_summary['2040대_매출_비중'].max() * 100
)

# 인구 구조 (높을수록 좋음)
evaluation_df['직장인구점수'] = (
    latest_worker.set_index('상권_코드_명')['총_직장_인구_수'] / 
    latest_worker['총_직장_인구_수'].max() * 100
)

evaluation_df['타겟인구점수'] = (
    latest_worker.set_index('상권_코드_명')['여성2040대_직장인구'] / 
    latest_worker['여성2040대_직장인구'].max() * 100
)

# 소득 수준 (높을수록 좋음)
evaluation_df['소득점수'] = (
    latest_income.set_index('상권_코드_명')['월_평균_소득_금액'] / 
    latest_income['월_평균_소득_금액'].max() * 100
)

# 접근성 점수 (높을수록 좋음)
evaluation_df['접근성점수'] = (
    latest_facilities.set_index('상권_코드_명')['대중교통_접근성'] / 
    latest_facilities['대중교통_접근성'].max() * 100
)

# 6-2. 종합 점수 계산 (가중치 적용)
weights = {
    '경쟁강도점수': 0.20,
    '여성매출점수': 0.15,
    '2040대매출점수': 0.15,
    '직장인구점수': 0.15,
    '타겟인구점수': 0.10,
    '소득점수': 0.10,
    '접근성점수': 0.15
}

evaluation_df['종합점수'] = sum(
    evaluation_df[col] * weight 
    for col, weight in weights.items()
)

evaluation_df = evaluation_df.round(2).sort_values('종합점수', ascending=False)

print("\n" + "=" * 60)
print("피부과 입지 종합 평가 결과")
print("=" * 60)
print(evaluation_df)

# 6-3. 시각화: 레이더 차트
from math import pi

categories = list(weights.keys())
N = len(categories)

angles = [n / float(N) * 2 * pi for n in range(N)]
angles += angles[:1]

fig, ax = plt.subplots(figsize=(10, 10), subplot_kw=dict(projection='polar'))

for location in evaluation_df.index:
    values = evaluation_df.loc[location, categories].values.tolist()
    values += values[:1]
    ax.plot(angles, values, 'o-', linewidth=2, label=location)
    ax.fill(angles, values, alpha=0.15)

ax.set_xticks(angles[:-1])
ax.set_xticklabels(categories)
ax.set_ylim(0, 100)
ax.set_title('상권별 피부과 입지 평가 레이더 차트', size=14, fontweight='bold', pad=20)
ax.legend(loc='upper right', bbox_to_anchor=(1.3, 1.1))
ax.grid(True)

plt.tight_layout()
plt.savefig(data_path + '../REPORT/종합평가_레이더차트.png', dpi=300, bbox_inches='tight')
plt.show()

# 6-4. 최종 추천
print("\n" + "=" * 60)
print("최종 입지 추천")
print("=" * 60)
print(f"1순위 추천: {evaluation_df.index[0]} (종합점수: {evaluation_df.iloc[0]['종합점수']:.2f})")
print(f"2순위 추천: {evaluation_df.index[1]} (종합점수: {evaluation_df.iloc[1]['종합점수']:.2f})")
print(f"3순위 추천: {evaluation_df.index[2]} (종합점수: {evaluation_df.iloc[2]['종합점수']:.2f})")
```

---

## 4. 추가 심화 분석 (선택사항)

### 4.1 유사 업종 벤치마킹

피부과와 타겟층이 유사한 업종 분석:

- **CS200030 (피부관리실)**: 미용 관심 고객층
- **CS200028 (미용실)**: 여성 고객 집중 업종
- **CS300022 (화장품)**: 피부 관리 관심층

```python
# 유사 업종 매출 패턴 분석
similar_industries = ['CS200030', 'CS200028', 'CS300022']

for code in similar_industries:
    industry_sales = df_sales[df_sales['서비스_업종_코드'] == code]
    industry_name = industry_sales['서비스_업종_코드_명'].iloc[0]
    
    print(f"\n{industry_name} 타겟층 분석")
    # 분석 코드...
```

### 4.2 계절성 분석

```python
# 분기별 매출 변동 패턴
seasonal_analysis = medical_sales.groupby(['상권_코드_명', '분기']).agg({
    '당월_매출_금액': 'mean'
}).reset_index()

seasonal_pivot = seasonal_analysis.pivot(
    index='분기', 
    columns='상권_코드_명', 
    values='당월_매출_금액'
)

print("\n분기별 평균 매출 (계절성 분석)")
print(seasonal_pivot)
```

### 4.3 상권 성장성 분석

```python
# 2022년 vs 2024년 비교
growth_analysis = medical_stores.groupby(['상권_코드_명', '년도'])['점포_수'].mean().unstack()
growth_analysis['성장률(%)'] = (
    (growth_analysis[2024] - growth_analysis[2022]) / growth_analysis[2022] * 100
)

print("\n상권별 성장률 분석")
print(growth_analysis)
```

---

## 5. 결과 리포트 작성 가이드

### 5.1 리포트 구성

1. **Executive Summary** (1페이지)
   - 분석 목적 및 방법론
   - 주요 발견사항 3가지
   - 최종 추천 입지 Top 3

2. **경쟁 환경 분석** (2-3페이지)
   - 상권별 의원 수 및 트렌드
   - 개폐업률 분석
   - 시장 포화도 평가

3. **타겟 고객 분석** (2-3페이지)
   - 여성/연령대별 매출 분석
   - 시간대별 유동 패턴
   - 인구 구조 분석

4. **종합 평가 및 추천** (2페이지)
   - 평가 지표별 점수
   - 레이더 차트
   - 최종 추천 및 근거

### 5.2 시각화 체크리스트

- [ ] 상권별 의원 점포 수 추이 그래프
- [ ] 타겟층 매출 비중 비교 차트
- [ ] 인구 구조 비교 차트
- [ ] 소득 및 의료비 지출 분석 차트
- [ ] 종합 평가 레이더 차트
- [ ] 상권 위치 지도 (선택)

### 5.3 결과물 저장

```python
# 분석 결과를 Excel로 저장
with pd.ExcelWriter(data_path + '../REPORT/피부과_입지분석_결과_20260203.xlsx', 
                    engine='openpyxl') as writer:
    evaluation_df.to_excel(writer, sheet_name='종합평가')
    target_summary.to_excel(writer, sheet_name='타겟층분석')
    churn_analysis.to_excel(writer, sheet_name='경쟁환경')
    latest_worker[['상권_코드_명', '총_직장_인구_수', '여성2040대_직장인구']].to_excel(
        writer, sheet_name='인구구조', index=False
    )
    latest_income[['상권_코드_명', '월_평균_소득_금액', '의료비_지출_비중']].to_excel(
        writer, sheet_name='소득소비', index=False
    )
    latest_facilities[['상권_코드_명', '지하철_역_수', '버스_정거장_수', '대중교통_접근성', '약국_수']].to_excel(
        writer, sheet_name='접근성', index=False
    )

print("\n분석 결과가 Excel 파일로 저장되었습니다.")
```

---

## 6. 주의사항 및 제한사항

> [!WARNING]
> **데이터 해석 시 주의사항**

1. **일반의원 데이터의 한계**
   - 현재 데이터는 피부과만 분리되지 않고 "일반의원" 전체 카테고리로 집계됨
   - 실제 피부과 비중은 별도 조사 필요

2. **시계열 데이터 기간**
   - 2022년 1분기 ~ 2024년 4분기 데이터만 포함
   - 코로나19 영향이 일부 포함되어 있을 수 있음

3. **상권 범위**
   - 분석 대상이 강남구 5개 주요 상권으로 제한됨
   - 인근 상권과의 경쟁 관계는 고려되지 않음

4. **가중치 조정**
   - 종합 평가의 가중치는 예시이며, 실제 사업 전략에 맞게 조정 필요

---

## 7. 참고 자료

### 7.1 업종 코드 매핑

| 코드 | 업종명 | 피부과 관련성 |
|------|--------|--------------|
| CS200006 | 일반의원 | ★★★★★ (피부과 포함) |
| CS200030 | 피부관리실 | ★★★★ (경쟁업종) |
| CS200028 | 미용실 | ★★★ (유사 타겟층) |
| CS300022 | 화장품 | ★★★ (유사 타겟층) |

### 7.2 데이터 출처

- **서울시 상권분석서비스**: 서울 열린데이터광장
- **수집 기간**: 2022년 1분기 ~ 2024년 4분기
- **업데이트 주기**: 분기별

---

**문서 버전**: 1.0  
**최종 수정일**: 2026-02-03  
**작성자**: EDA 분석팀
